<ng-template #optionsTemplate>
  <ul
    *ngIf="optionsOpened"
    alignment
    role="menu"
    class="ui-select-choices dropdown-menu"
    [alignTarget]="inputRef"
    [autoAlignEnabled]="autoAlignEnabled"
  >
    <li *ngIf="filterEnabled"
        class="app-select-search-wrapper">
      <input
        focus
        type="text"
        class="form-control app-select-search"
        [(ngModel)]="filterValue"
      >
    </li>
    <li
      *ngFor="let action of actions"
      role="menuitem"
      class="ui-select-unselectable"
    >
      <div
        class="ui-select-action"
        (click)="actionClick(action, $event)"
      >
        {{ action.text | translate }}
        <span
          *ngIf="action.actionIconCls"
          class="ui-select-action-btn {{action.actionIconCls}}">
        </span>
      </div>
    </li>
    <li
      *ngFor="let rawItem of rawData | rawDataFilter: { sortType: sortType }"
      role="menuitem"
    >
      <div
        class="ui-select-choices-row"
        [ngClass]="{ active: isActive(rawItem) }"
        (mouseenter)="selectActive(rawItem)"
        (click)="selectMatch(rawItem, $event)"
      >
        <div
          class="dropdown-item"
          [innerHtml]="toDisplayValue(rawItem)">
        </div>
      </div>
    </li>
  </ul>
</ng-template>

<div
  class="ui-select-container dropdown open"
  *ngIf="multiple === false"
  [ngStyle]="styles"
  [attr.disabled]="disabled"
  [offClick]="clickedOutside"
  (keyup)="mainClick($event)"
>
  <div class="ui-select-match"
       *ngIf="!inputMode">
      <span tabindex="-1"
            class="btn btn-default btn-secondary form-control ui-select-toggle"
            (click)="matchClick($event)">
        <span *ngIf="active.length <= 0" class="ui-select-placeholder text-muted">{{ placeholder | translate }}</span>
        <span *ngIf="active.length" class="ui-select-match-text pull-left"
              [innerHTML]="toDisplayValue(active[0])"></span>
        <i class="dropdown-toggle pull-right"></i>
        <i class="caret pull-right"></i>
      </span>
  </div>
  <input #input
         type="text"
         autocomplete="false"
         tabindex="-1"
         [attr.readonly]="readonly"
         [ngClass]="{ hidden: !isInputVisible()}"
         class="form-control ui-select-search"
         *ngIf="inputMode"
         [placeholder]="displayPlaceholder">
  <ng-container *ngTemplateOutlet="optionsTemplate">
  </ng-container>
</div>

<div tabindex="0"
     [ngStyle]="styles"
     [attr.disabled]="disabled"
     *ngIf="multiple === true"
     (keyup)="mainClick($event)"
     [offClick]="clickedOutside"
     class="ui-select-container ui-select-multiple dropdown form-control open">
      <span class="ui-select-match">
          <span *ngFor="let activeItem of active"
                class="ui-select-match-item btn btn-default btn-secondary btn-xs"
                tabindex="-1"
                type="button"
                (click)="activeItemClick(activeItem, $event)"
                [ngClass]="{'btn-default': true, 'selected': activeItem.selected, 'context-exist': isItemContextExist(activeItem)}">
             <a *ngIf="canCloseSelectedItem(activeItem)"
                class="close"
                style="margin-left: 5px; padding: 0;"
                (click)="removeClick(activeItem, $event)">&times;
             </a>
             <span [innerHtml]="toDisplayValue(activeItem)"></span>
          </span>
          <i class="dropdown-toggle pull-right"></i>
          <i class="caret pull-right"></i>
    </span>
  <input
    #input
    type="text"
    (click)="matchClick($event)"
    [attr.readonly]="readonly"
    [ngClass]="{ hidden: !isInputVisible()}"
    autocomplete="false"
    autocorrect="off"
    autocapitalize="off"
    spellcheck="false"
    class="form-control ui-select-search"
    [placeholder]="displayPlaceholder"
    role="combobox"
  >
  <ng-container *ngTemplateOutlet="optionsTemplate">
  </ng-container>
</div>
